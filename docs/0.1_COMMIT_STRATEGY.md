# Climate & Impact Global Tracker - Commit Strategy

This document outlines the granular commit history for building the project. Each step enables a specific feature, adding dependencies only when the code that uses them is introduced. This approach maximizes learnability by isolating specific technology implementations.

---

## üèóÔ∏è Stage 0: Foundation & Setup

### 0.1. Initialize Repository & Monorepo Structure
- **Message:** `chore: init monorepo structure and gitignore`
- **Files:**
    - `.gitignore` (Node, Mac, Linux, Env)
    - `README.md` (Project Title)
    - `docs/` (Move existing docs here)

### 0.2. Frontend Scaffolding
- **Message:** `init(frontend): scaffold vite react-ts project`
- **Files:**
    - `frontend/package.json` (React, TypeScript, Vite)
    - `frontend/vite.config.ts`
    - `frontend/tsconfig.json`
    - `frontend/src/App.tsx` (Hello World)

### 0.3. Backend Scaffolding
- **Message:** `init(backend): scaffold node express-ts server`
- **Cmd:** `npm install express cors dotenv` | `npm install -D typescript @types/express @types/node ts-node nodemon`
- **Files:**
    - `backend/package.json`
    - `backend/tsconfig.json`
    - `backend/src/index.ts` (Basic Express listening on 5000)
    - `backend/.env.example`

### 0.4. Docker Environment
- **Message:** `chore(infra): add docker-compose for base services`
- **Files:**
    - `docker-compose.yml` (Empty initially or just a placeholder network)

---

## üå°Ô∏è Stage 1: Backend Services & APIs

### 1.1. OpenWeatherMap Integration
- **Message:** `feat(backend): implement openweathermap service`
- **Cmd:** `npm install axios`
- **Files:**
    - `backend/package.json` (added axios)
    - `backend/src/services/weatherService.ts` (API call logic)
    - `backend/src/routes/weatherRoutes.ts`
    - `backend/src/types/weather.ts` (Interfaces)

### 1.2. Input Validation
- **Message:** `feat(backend): add request validation with zod`
- **Cmd:** `npm install zod`
- **Files:**
    - `backend/package.json` (added zod)
    - `backend/src/middleware/validate.ts`
    - `backend/src/schemas/weatherSchema.ts`

### 1.3. Redis Caching Support
- **Message:** `feat(backend): implement redis caching layer`
- **Cmd:** `npm install redis`
- **Files:**
    - `backend/package.json` (added redis)
    - `docker-compose.yml` (Add Redis service)
    - `backend/src/config/redis.ts` (Connection logic)
    - `backend/src/middleware/cache.ts` (Middleware to check/set cache)
    - `backend/src/routes/weatherRoutes.ts` (Apply middleware)

### 1.4. Logging System
- **Message:** `feat(backend): add structured logging with winston`
- **Cmd:** `npm install winston`
- **Files:**
    - `backend/package.json` (added winston)
    - `backend/src/utils/logger.ts`
    - `backend/src/middleware/error.ts` (Use logger in error handler)

---

## üó∫Ô∏è Stage 2: Frontend Base & Maps

### 2.1. Styling Frameworks
- **Message:** `style(frontend): setup tailwindcss`
- **Cmd:** `npm install -D tailwindcss postcss autoprefixer`
- **Files:**
    - `frontend/tailwind.config.js`
    - `frontend/src/index.css`

### 2.2. Mapbox Basics
- **Message:** `feat(frontend): integrate mapbox gl`
- **Cmd:** `npm install mapbox-gl @types/mapbox-gl`
- **Files:**
    - `frontend/package.json` (added mapbox-gl)
    - `frontend/src/components/Map/MapContainer.tsx` (Basic map render)
    - `frontend/.env` (Mapbox Token)

### 2.3. State Management
- **Message:** `feat(frontend): setup weather store with zustand`
- **Cmd:** `npm install zustand`
- **Files:**
    - `frontend/package.json` (added zustand)
    - `frontend/src/store/weatherStore.ts` (State definition)

### 2.4. API Integration
- **Message:** `feat(frontend): connect to backend weather api`
- **Cmd:** `npm install axios @tanstack/react-query`
- **Files:**
    - `frontend/package.json` (added axios, react-query)
    - `frontend/src/services/api.ts`
    - `frontend/src/hooks/useWeather.ts`

---

## üå™Ô∏è Stage 3: Climate Layers & Visualization

### 3.1. Layer Management
- **Message:** `feat(frontend): add map layer control system`
- **Files:**
    - `frontend/src/components/Map/LayerManager.tsx`
    - `frontend/src/store/layerStore.ts`

### 3.2. Heatmap Layer
- **Message:** `vis(frontend): implement temperature heatmap`
- **Files:**
    - `frontend/src/components/Map/layers/TemperatureLayer.tsx` (Mapbox addLayer logic)

---

## üåç Stage 4: 3D Visualization (Three.js)

### 4.1. 3D Environment Setup
- **Message:** `feat(frontend): setup r3f environment`
- **Cmd:** `npm install three @react-three/fiber @react-three/drei`
- **Files:**
    - `frontend/package.json` (added three deps)
    - `frontend/src/components/Globe/GlobeContainer.tsx` (Canvas setup)

### 4.2. Globe Geometry
- **Message:** `vis(frontend): render basic interactive globe`
- **Files:**
    - `frontend/src/components/Globe/EarthMesh.tsx`
    - `frontend/public/textures/earth_daymap.jpg`

### 4.3. Data Instancing
- **Message:** `perf(frontend): implement instanced mesh for data points`
- **Files:**
    - `frontend/src/components/Globe/DataPoints.tsx` (Use `instancedMesh` for 10k points)
    - `frontend/src/utils/geoToVector.ts` (Math helpers)

---

## ‚ö° Stage 5: Real-time Updates

### 5.1. Backend Socket Server
- **Message:** `feat(backend): setup socket.io server`
- **Cmd:** `npm install socket.io`
- **Files:**
    - `backend/package.json`
    - `backend/src/socket/socketService.ts`
    - `backend/src/index.ts` (Attach socket to http server)

### 5.2. Frontend Socket Client
- **Message:** `feat(frontend): integrate socket.io client`
- **Cmd:** `npm install socket.io-client`
- **Files:**
    - `frontend/package.json`
    - `frontend/src/hooks/useSocket.ts`
    - `frontend/src/store/weatherStore.ts` (Action to handle realtime updates)

---

## üìä Stage 6: Data & Analytics

### 6.1. Time-Series DB
- **Message:** `feat(backend): integrate influxdb`
- **Cmd:** `npm install @influxdata/influxdb-client`
- **Files:**
    - `docker-compose.yml` (Add InfluxDB)
    - `backend/src/services/influxService.ts`

### 6.2. Grafana Dashboard
- **Message:** `feat(infra): add grafana dashboarding`
- **Files:**
    - `docker-compose.yml` (Add Grafana)
    - `config/grafana/provisioning/` (Auto-load dashboards)
